{% extends 'base.html' %}
{% block title %}{{ article.title }} – News – Aixtraball{% endblock %}
{% block meta_description %}{{ article.excerpt or "Neuigkeiten vom Aixtraball e.V." }}{% endblock %}
{% block head_extra %}
<meta property="og:image" content="{{ (article.images[0] | asset) if article.images else url_for('static', filename='images/slides/hall.jpg', _external=True) }}">
<meta name="twitter:image" content="{{ (article.images[0] | asset) if article.images else url_for('static', filename='images/slides/hall.jpg', _external=True) }}">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  "headline": {{ (article.title or '') | tojson }},
  "datePublished": {{ (article.date or '') | tojson }},
  "dateModified": {{ (article.date or '') | tojson }},
  "author": {"@type": "Organization", "name": "Aixtraball e.V."},
  "publisher": {"@type": "Organization", "name": "Aixtraball e.V.", "logo": {"@type":"ImageObject","url": "{{ url_for('static', filename='images/logo.png', _external=True) }}"}},
  "image": {{ (article.images[0] | asset) | tojson if article.images else (url_for('static', filename='images/slides/hall.jpg', _external=True) | tojson) }},
  "mainEntityOfPage": "{{ request.base_url }}"
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {"@type": "ListItem", "position": 1, "name": "News", "item": "{{ url_for('news_list', _external=True) }}"},
    {"@type": "ListItem", "position": 2, "name": {{ (article.title or '') | tojson }}, "item": "{{ request.base_url }}"}
  ]
}
</script>
{% endblock %}
{% block content %}
<section class="py-5">
  <div class="container">
    <h1 class="mb-3">{{ article.title }}</h1>
    <p class="text-muted">{{ article.date | datetimeformat('%d.%m.%Y') }}</p>
    {% if article.images %}
      <div class="row g-4 mb-3">
        <div class="col-md-8">
          <a href="{{ article.images[0] | asset }}" class="glightbox" data-gallery="news-gallery">
            <img src="{{ article.images[0] | asset }}" class="img-fluid rounded mb-3" alt="{{ article.title }}" loading="lazy" decoding="async">
          </a>
          {{ article.content | safe }}
        </div>
        {% if article.images|length > 1 %}
        <div class="col-md-4">
          <div class="row row-cols-2 g-2">
            {% for img in article.images[1:] %}
              <div class="col">
                <a href="{{ img | asset }}" class="glightbox" data-gallery="news-gallery">
                  <img src="{{ img | asset }}" class="img-fluid rounded" alt="{{ article.title }}" loading="lazy" decoding="async">
                </a>
              </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}
      </div>
    {% else %}
      {{ article.content | safe }}
    {% endif %}
    {% if article.youtube_links %}
      <div class="ratio ratio-16x9 my-4">
        <iframe src="{{ article.youtube_links[0] | replace('watch?v=', 'embed/') }}" allowfullscreen></iframe>
      </div>
    {% endif %}
    <a href="{{ url_for('news_list') }}">&larr; Zurück zu allen News</a>
  </div>
</section>
{% endblock %}
