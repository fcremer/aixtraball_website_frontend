{% extends "base.html" %}

{% block content %}
<div class="container" style="margin-top:6rem;">
  <h2 class="mb-4">{{ name.replace('_', ' ').title() }} bearbeiten</h2>
  <form method="post">
    <div id="items">
      {% for item in data %}
      <div class="row g-2 mb-3 item-row">
        {% for field in fields %}
        <div class="col">
          <input type="text" class="form-control" name="{{ loop.parent.loop.index0 }}-{{ field }}" value="{{ item.get(field, '') }}" placeholder="{{ field }}">
        </div>
        {% endfor %}
      </div>
      {% endfor %}
      {% if data|length == 0 %}
      <div class="row g-2 mb-3 item-row">
        {% for field in fields %}
        <div class="col">
          <input type="text" class="form-control" name="0-{{ field }}" placeholder="{{ field }}">
        </div>
        {% endfor %}
      </div>
      {% endif %}
    </div>
    <button type="button" id="add-row" class="btn btn-outline-secondary mb-3">Eintrag hinzuf√ºgen</button>
    <div class="text-end">
      <button class="btn btn-primary">Speichern</button>
    </div>
  </form>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('add-row').addEventListener('click', function(){
  const container = document.getElementById('items');
  const template = container.querySelector('.item-row');
  const clone = template.cloneNode(true);
  const index = container.querySelectorAll('.item-row').length;
  clone.querySelectorAll('input').forEach(function(inp){
    const parts = inp.name.split('-');
    inp.name = index + '-' + parts[1];
    inp.value = '';
  });
  container.appendChild(clone);
});
</script>
{% endblock %}

